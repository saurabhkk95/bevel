apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: supplychainvalidator4validator-node
  namespace: supplychain-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainvalidator4validator-node
  interval: 1m
  chart:
   spec:
    chart: platforms/hyperledger-besu/charts/node_validator
    sourceRef:
      kind: GitRepository
      name: flux-sau
      namespace: flux-sau
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://b0a2678effed13eb1418c9dc69cfb35a67659964f4d61215eba93ee64309bf0c1ccae56b9b257c5a9283ecb75c766dc4f1a27ec67b36aa4b39d96db4e6ad91e3@validator1.bes.dev2.aws.blockchaincloudpoc-develop.com:15010"
      - "enode://3189cca94931d271166273003369d83be40333e13104bd4470dcb7927385896b42680f7b370d5ea1edb16c3592fd6fd6c0337986face6734dfc9a0678e2acb91@validator2.bes.dev2.aws.blockchaincloudpoc-develop.com:15012"
      - "enode://cf2d7aba191885484fb2094f7124a25b09ee4208942eb11914e81be2aec1924dce75a7790c7089dccecdfb7eb8585dd49d447d118d086b86a244ed406bc262de@validator3.bes.dev2.aws.blockchaincloudpoc-develop.com:15014"
      - "enode://dae1c8c477c39d12471e9746b5f5e01d63054cefd701fda7b2fcc34e3dd9b93e5f152190ee2b4366945d6a15ebb5d976212651bd55bc7d9817dd1a24ff6cbc73@validator4.bes.dev2.aws.blockchaincloudpoc-develop.com:15016"
      - "enode://cb0b554fb3fa7d917e17e5194ca567b51e706b8a89ca88fca06cd20b8824de70a39174808ce297816d27a6f6b7fde6639a2e69f4f9e4ec6e8cb5d92d71373621@carriers.bes.dev2.aws.blockchaincloudpoc-develop.com:15018"

    metadata:
      namespace: supplychain-bes
      labels:

    ambassador:
      external_url_suffix: bes.dev2.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
    proxy:
      provider: ambassador
      external_url: supplychain.bes.dev2.aws.blockchaincloudpoc-develop.com
      p2p: 15016
      rpc: 15017

    images:
      node: hyperledger/besu:21.10.6
      alpineutils: ghcr.io/hyperledger/bevel-alpine:latest
      pullPolicy: IfNotPresent

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://a94f258ac51304b63a9bceb42a204cb6-2100507752.eu-west-1.elb.amazonaws.com:20002
      secretprefix: secretsv2/data/supplychain-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychain

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDkzYjI0ZWM0MzAwNDE0MWRjMTJjY2Q4NzBlNjZjZWZkMjY1NmRiMzQ5NDg1MTM0MmE3ZDNmOTUyYjc5ODU1NmYyOTZkNjNlOWY3MDgwZTMxMGU5NDBmY2I3MGJmMzYxYTNhOWY3NTRjYmVlOTI2OTAyMjZlOGYxZTA1NWY5NGE3ZTBjNzE1OTk3OGFmNTk5NWE3NTIzMWM0ZGIzMTVlZTFlMmUzMGI4MDg0MDAwMDAwMDBjMCIKfQ==
